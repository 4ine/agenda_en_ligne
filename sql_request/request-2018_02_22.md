# Requêtes base de données Sakila


## Cours du 22 février 2018

1. Sélectionner le nom des `films` et leur `catégorie`, n'afficher que les films qui finissent pas la lettre `S`

 - **SELECT f.title, c.name FROM sakila.film as f
join sakila.film_category as fc on f.film_id = fc.film_id
join sakila.category as c on c.category_id = fc.category_id
where title like "%s"
;**


2. Sélectionner la liste des `catégories` et le nombre de `films` associés à chaque `catégorie`.

 - **SELECT count(*) as nombre, c.name FROM sakila.category as c
 join film_category as fc on fc.category_id = c.category_id
 group by c.name;**

3. Sélectionner les `acteurs` (nom et prénom), les `films` dans lesquels ils ont joués et la langue de chaque `film`.

 - **select a.first_name, a.last_name, f.title, l.name from sakila.actor as a
join film_actor as fa on fa.actor_id = a.actor_id
join film as f on f.film_id = fa.film_id
join language as l on l.language_id = f.language_id;**


4. Sélectionner les `films` : titre, temps de location (rental_duration) et durée du film (length). Le temps de location doit être sous le format **XX mois** et la durée du film doit être sous le format **hh:mm:ss**.

 - **SELECT title,
  CONCAT(rental_duration, ' mois') as rental_duration,
  SEC_TO_TIME(length*60) AS durationInTime
  FROM sakila.film;**

5. Sélectionner le dernier `film` de chaque `catégorie` (nom de la catégorie, id du film et le titre du film).

 - **select name, max(f.film_id), max(title)
 from film as f, film_category as fc, category as c
 where f.film_id=fc.film_id
 and fc.category_id=c.category_id
 group by fc.category_id;**

![Customer Data](images/request_2018_02_22.JPG)
